 freeStyleJob("DockerPublish")
{
  description ("Simple Hello World")
scm 
{
     git {
         remote {
              name("origin")
              url("https://bitbucket.org/andriybahlai/hello-world-full/src")
              credentials("bitbucket")
             }
            branch("*/master")
        }
    }
    triggers
  {
    scm('* * * * *')
  }
    steps
  {
     shell ( "sudo docker build -t hello-world .")
     shell ( "aws ecr get-login --region us-west-2 > docker-login.sh")
     shell ( "chmod +x docker-login.sh && sudo ./docker-login.sh")
     shell ( "sudo docker tag hello-world:latest 647177513724.dkr.ecr.us-west-2.amazonaws.com/skuchain-devops:latest")
     shell ( "sudo docker push 647177513724.dkr.ecr.us-west-2.amazonaws.com/skuchain-devops:latest")
  }
}
